<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="AngieLee" />



<meta name="description" content="上一章的数据链路层内容真的好多，光md文件就有62KB 再加上中间跑去刷算法了，就鸽了很久 但是细心的可以发现，算法的最后一篇和这篇的发布时间是隔了一段时间的 就是小黎刷算法太累了给自己放了个小长假 总之终于开始新的一章啦！">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络网课笔记-网络层">
<meta property="og:url" content="https://angielee233.github.io/2022/03/18/computerInternet-4/index.html">
<meta property="og:site_name" content="小黎的小窝">
<meta property="og:description" content="上一章的数据链路层内容真的好多，光md文件就有62KB 再加上中间跑去刷算法了，就鸽了很久 但是细心的可以发现，算法的最后一篇和这篇的发布时间是隔了一段时间的 就是小黎刷算法太累了给自己放了个小长假 总之终于开始新的一章啦！">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qFBGmn.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qF66J0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qF6zTA.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qFWubF.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qFRTBD.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkA6SJ.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkEIH0.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkVGKs.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkZPZq.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkn0T1.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkuZA1.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkuOgO.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkMEJx.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qk35DO.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qk8XFJ.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkJxr6.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qka69e.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/18/qkaQ00.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qAxKCn.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qAzkGR.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qESzEF.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qE9es0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qE9WTS.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEEqgg.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEAFiT.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEA2mn.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEA76J.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEesNq.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEmlxU.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEmOJ0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEu9c8.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEuIEj.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEKVqe.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEM9eg.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEQLxP.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEJzZV.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEJTIS.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEUpIf.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qELPt1.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEODIA.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qEjB9I.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVp1O0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVpBOx.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVpnYQ.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVitD1.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVAvPf.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVEjm9.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVVmkt.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVZEgU.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVZr28.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVnaVJ.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVKtAJ.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVM4i9.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qVQsFH.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qV1LZT.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qV3VFe.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qV3jnP.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qV8i1s.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/19/qV8f3j.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZnTXT.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZKjQx.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZlCRA.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZlNi4.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ1I39.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZU3Lj.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZUywR.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZaE1U.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZaj4x.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZdnxS.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ0gDe.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ0j5n.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ0D9x.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZBbz6.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZDQS0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZDNk9.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZRTFU.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZfqq1.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZhcWD.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ43Xd.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ4gA0.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZTyxU.md.png">
<meta property="og:image" content="https://s1.ax1x.com/2022/03/20/qZ7nzT.md.png">
<meta property="article:published_time" content="2022-03-18T08:29:48.739Z">
<meta property="article:modified_time" content="2022-03-20T08:39:29.742Z">
<meta property="article:author" content="AngieLee">
<meta property="article:tag" content="网络层">
<meta property="article:tag" content="IPv4">
<meta property="article:tag" content="静态路由配置">
<meta property="article:tag" content="路由选择协议">
<meta property="article:tag" content="RIP">
<meta property="article:tag" content="OSPF">
<meta property="article:tag" content="BGP">
<meta property="article:tag" content="ICMP">
<meta property="article:tag" content="VPN">
<meta property="article:tag" content="NAT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2022/03/18/qFBGmn.md.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="小黎的小窝" type="application/atom+xml">



    <link rel="shortcut icon" href="/icon/USAO.jpg">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>计算机网络网课笔记-网络层 | 小黎的小窝</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 6.0.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/usao.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Angie Lee</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="/angielee@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/AngieLee233" title="GitHub"></a>
                            
                                <a class="fa 知乎" target="_blank" rel="noopener" href="https://www.zhihu.com/people/li-da-sha-45-40" title="知乎"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">感谢信收割机</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Angie Lee</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/usao.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Angie Lee</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="/angielee@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/AngieLee233" title="GitHub"></a>
                            
                                <a class="fa 知乎" target="_blank" href="https://www.zhihu.com/people/li-da-sha-45-40" title="知乎"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-computerInternet-4" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2022/03/18/computerInternet-4/" class="article-date">
      <time datetime="2022-03-18T08:29:48.739Z" itemprop="datePublished">2022-03-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      计算机网络网课笔记-网络层
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E5%B0%8F%E9%BB%8E%E4%B8%8E%E8%AE%A1%E7%BD%91%E7%9A%84%E7%88%B1%E6%81%A8%E6%83%85%E4%BB%87/">小黎与计网的爱恨情仇</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BGP/" rel="tag">BGP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ICMP/" rel="tag">ICMP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IPv4/" rel="tag">IPv4</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NAT/" rel="tag">NAT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OSPF/" rel="tag">OSPF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RIP/" rel="tag">RIP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VPN/" rel="tag">VPN</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82/" rel="tag">网络层</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE/" rel="tag">路由选择协议</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE/" rel="tag">静态路由配置</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>上一章的数据链路层内容真的好多，光md文件就有62KB</p>
<p>再加上中间跑去刷算法了，就鸽了很久</p>
<p>但是细心的可以发现，算法的最后一篇和这篇的发布时间是隔了一段时间的</p>
<p><s>就是小黎刷算法太累了给自己放了个小长假</s></p>
<p>总之终于开始新的一章啦！</p>
<span id="more"></span>
<h1>网络层概述</h1>
<ul>
<li>网络层的主要任务是<strong>实现网络互连</strong>，进而实现<strong>数据包在各网络之间的传输</strong>。</li>
<li>要实现网络层任务，需要解决以下主要问题：
<ul>
<li>网络层向运输层提供怎样的服务（“可靠传输”还是“不可靠传输”）</li>
<li>网络层寻址问题</li>
<li>路由选择问题</li>
</ul>
</li>
<li><strong>因特网</strong>（Internet）是目前全世界用户数量最多的互联网，它使用<strong>TCP/IP协议栈</strong>。</li>
<li>由于TCP/IP协议栈的网络层使用<strong>网际协议IP</strong>，它是整个协议栈的核心协议，因此在TCP/IP协议栈中网络层常称为<strong>网际层</strong>。</li>
<li>本章通过学习TCP/IP协议栈的网际层来学习网络层的理论知识和实践技术。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qFBGmn"><img src="https://s1.ax1x.com/2022/03/18/qFBGmn.md.png" alt="qFBGmn.png"></a></p>
<h1>网络层提供的两种服务</h1>
<h2 id="面向连接的虚电路服务">面向连接的虚电路服务</h2>
<ul>
<li>核心思想：<strong>可靠通信由网络来保证</strong></li>
<li>必须建立<strong>网络层的连接</strong>——<strong>虚电路VC</strong>（Virtual Circuit）</li>
<li>通信双方<strong>沿着已建立的虚电路发送分组</strong></li>
<li>目的主机的地址仅在连接建立阶段使用，之后每个<strong>分组的首部只需携带一条虚电路的编号</strong>（构成虚电路的每一段链路都有一个虚电路编号）。</li>
<li>这种通信方式如果再使用可靠传输的网络协议，就可使所发送的分组最终正确到达接收方（无差错按序到达、不丢失、不重复）。</li>
<li><strong>通信结束后，需要释放之前所建立的虚电路</strong>。</li>
<li>很多广域分组交换网都使用面向连接的虚电路服务。例如，曾经的X．25和逐渐过时的帧中继FR、异步传输模式ATM等。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qF66J0"><img src="https://s1.ax1x.com/2022/03/18/qF66J0.md.png" alt="qF66J0.md.png"></a></p>
<h2 id="无连接的数据报服务">无连接的数据报服务</h2>
<ul>
<li>核心思想：<strong>可靠通信应当由用户主机来保证</strong></li>
<li><strong>不需要建立网络层连接</strong></li>
<li><strong>每个分组可走不同的路径</strong></li>
<li>每个分组的<strong>首部必须携带目的主机的完整地址</strong></li>
<li>这种通信方式所传送的<strong>分组可能误码</strong>、<strong>丢失</strong>、<strong>重复</strong>和<strong>失序</strong>。</li>
<li>由于<strong>网络本身不提供端到端的可靠传输服务</strong>，这就使网络中的路由器可以做得比较简单，而且价格低廉（与电信网的交换机相比较）。</li>
<li>因特网采用了这种设计思想，也就是<strong>将复杂的网络处理功能置于因特网的边缘（用户主机和其内部的运输层）</strong>，而将相对简单的尽最大努力的分组交付功能置于因特网核心。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qF6zTA"><img src="https://s1.ax1x.com/2022/03/18/qF6zTA.md.png" alt="qF6zTA.md.png"></a></p>
<h2 id="虚电路服务与数据报服务的比较">虚电路服务与数据报服务的比较</h2>
<table>
<thead>
<tr>
<th>对比方面</th>
<th>虚电路服务</th>
<th>数据报服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>思路</td>
<td>可靠通信应当由网络来保证</td>
<td>可靠通信应当由用户主机来保证</td>
</tr>
<tr>
<td>连接的建立</td>
<td>必须建立网络层连接</td>
<td>不需要建立网络层连接</td>
</tr>
<tr>
<td>终点地址</td>
<td>仅在连接建立阶段使用，每个分组使用短的虚电路号</td>
<td>每个分组都有终点的完整地址</td>
</tr>
<tr>
<td>分组的转发</td>
<td>属于同一条虚电路的分组均按照同一路由进行转发</td>
<td>每个分组可走不同的路由</td>
</tr>
<tr>
<td>当结点出故障时</td>
<td>所有通过出故障的结点的虚电路均不能工作</td>
<td>出故障的结点可能会丢失分组，一些路由可能会发生变化</td>
</tr>
<tr>
<td>分组的顺序</td>
<td>总是按发送顺序到达终点</td>
<td>到达终点时不一定按发送顺序</td>
</tr>
<tr>
<td>服务质量保证</td>
<td>可以将通信资源提前分配给每一个虚电路，容易实现</td>
<td>很难实现</td>
</tr>
</tbody>
</table>
<p>由于TCP/IP体系结构的因特网的网际层提供的是简单灵活、无连接的、尽最大努力交付的数据报服务，因此本章主要围绕网际层如何传送IP数据报这个主题进行讨论。</p>
<h1>IPv4地址</h1>
<ul>
<li><strong>IPv4地址</strong>就是给因特网（Internet）上的<strong>每一台主机（或路由器）的每一个接口</strong>分配一个在全世界范围内是<strong>唯一的32比特的标识符</strong>。</li>
<li>IP地址由因特网名字和数字分配机构ICANN（Internet Corporation for Assigned Names and Numbers）进行分配。
<ul>
<li>我国用户可向亚太网络信息中心APNIC（Asia Pacific Network Information Center）申请IP地址，需要缴费。</li>
<li>2011年2月3日，互联网号码分配管理局IANA（由ICANN行使职能）宣布，IPv4地址已经分配完毕。</li>
<li>我国在2014至2015年也逐步停止了向新用户和应用分配IPv4地址。同时全面开展商用部署IPv6。</li>
</ul>
</li>
<li><strong>IPv4地址的编址方法经历了如下三个历史阶段：</strong></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qFWubF"><img src="https://s1.ax1x.com/2022/03/18/qFWubF.md.png" alt="qFWubF.md.png"></a></p>
<ul>
<li>32比特的IPv4地址不方便阅读、记录以及输入等，因此IPv4地址采用<strong>点分十进制表示方法</strong>以方便用户使用。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qFRTBD"><img src="https://s1.ax1x.com/2022/03/18/qFRTBD.md.png" alt="qFRTBD.md.png"></a></p>
<h2 id="分类编址的IPv4地址">分类编址的IPv4地址</h2>
<p>分类编址的IPv4地址分为A、B、C、D、E五类</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkA6SJ"><img src="https://s1.ax1x.com/2022/03/18/qkA6SJ.md.png" alt="qkA6SJ.png"></a></p>
<p>需要注意的是：</p>
<ul>
<li>只有A类、B类和C类地址可分配给网络中的主机或路由器的各接口</li>
<li>主机号为“全0”的地址是网络地址，不能分配给主机或路由器的各接口</li>
<li>主机号为“全1”的地址是广播地址，不能分配给主机或路由器的各接口</li>
</ul>
<h3 id="A类地址">A类地址</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkEIH0"><img src="https://s1.ax1x.com/2022/03/18/qkEIH0.png" alt="qkEIH0.png"></a></p>
<h3 id="B类地址">B类地址</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkVGKs"><img src="https://s1.ax1x.com/2022/03/18/qkVGKs.png" alt="qkVGKs.png"></a></p>
<h3 id="C类地址">C类地址</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkZPZq"><img src="https://s1.ax1x.com/2022/03/18/qkZPZq.png" alt="qkZPZq.png"></a></p>
<h3 id="ABC类IP地址类别判断">ABC类IP地址类别判断</h3>
<ol>
<li>
<p>根据地址左起第一个十进制数的值，可以判断出网络类别（小于127的为A类，128～191的为B类，192～223的为C类）</p>
</li>
<li>
<p>根据网络类别，就可找出地址中的网络号部分和主机号部分（A类地址网络号为左起第一个字节，B类地址网络号为左起前两个字节，C类地址网络号为左起前三个字节）</p>
</li>
<li>
<p>以下三种情况的地址不能指派给主机或路由器接口：</p>
<ol>
<li>A类网络号0和127</li>
<li>主机号为“全0”，这是网络地址</li>
<li>主机号为“全1”，这是广播地址</li>
</ol>
</li>
</ol>
<h3 id="特殊的IPv4地址">特殊的IPv4地址</h3>
<p>地址0.0.0.0是一个特殊的IPv4地址，只能作为源地址使用，表示“在本网络上的本主机”封装有DHCP Discovery报文的IP分组的源地址使用0.0.0.0。</p>
<p>以127开头且后面三个字节非“全0”或“全1”的IP地址是一类特殊的IPv4地址，既可以作为源地址使用，也可以作为目的地址使用，用于本地软件环回测试，例如常用的环回测试地址127.0.0.1。</p>
<p>地址255.255.255.255是一个特殊的IPv4地址，只能作为目的地址使用，表示“只在本网络上进行广播（各路由器均不转发）”。</p>
<p>还有一些一般不使用的特殊IP地址如下：</p>
<table>
<thead>
<tr>
<th>网络号</th>
<th>主机号</th>
<th>作为源地址</th>
<th>作为目的地址</th>
<th>代表的含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>可以</td>
<td>不可</td>
<td>在本网络上的本主机(DHCP协议)</td>
</tr>
<tr>
<td>0</td>
<td>host-id</td>
<td>可以</td>
<td>不可</td>
<td>在本网络上的某台主机host-id</td>
</tr>
<tr>
<td>全1</td>
<td>全1</td>
<td>不可</td>
<td>可以</td>
<td>只在本网络上进行广播(各路由器均不转发)</td>
</tr>
<tr>
<td>net-id</td>
<td>全1</td>
<td>不可</td>
<td>可以</td>
<td>对net-id上的所有主机进行广播</td>
</tr>
<tr>
<td>127</td>
<td>非全0或全1</td>
<td>可以</td>
<td>可以</td>
<td>用于本地软件环回测试</td>
</tr>
</tbody>
</table>
<h2 id="划分子网的IPv4地址">划分子网的IPv4地址</h2>
<ul>
<li>为新增网络申请新的网络号会带来以下弊端：
<ul>
<li>需要等待时间和花费更多的费用</li>
<li>会增加其他路由器中路由表记录的数量</li>
<li>浪费原有网络号中剩余的大量IP地址</li>
</ul>
</li>
<li>可以从主机号部分借用一部分比特作为子网号</li>
</ul>
<h3 id="子网掩码">子网掩码</h3>
<p><strong>32比特的子网掩码可以表明分类IP地址的主机号部分被借用了几个比特作为子网号</strong>：</p>
<ul>
<li>子网掩码使用<strong>连续的比特1来对应网络号和子网号</strong></li>
<li>子网掩码使用<strong>连续的比特0来对应主机号</strong></li>
<li>将划分子网的<strong>IPv4地址</strong>与其相应的<strong>子网掩码</strong>进行<strong>逻辑与运算</strong>就可得到IPv4地址<strong>所在子网的网络地址</strong></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkn0T1"><img src="https://s1.ax1x.com/2022/03/18/qkn0T1.md.png" alt="qkn0T1.md.png"></a></p>
<h3 id="子网划分细节">子网划分细节</h3>
<p>给定一个分类的IP地址和其相应的子网掩码，就可知道子网划分的细节：</p>
<ul>
<li>划分出的子网数量</li>
<li>每个子网可分配的IP地址数量</li>
<li>每个子网的网络地址和广播地址</li>
<li>每个子网可分配的最小和最大地址</li>
</ul>
<p>例如，已知某个网络的地址为<strong>218.75.230.0</strong>，使用子网掩码<strong>255.255.255.128</strong>对其进行划分：</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkuZA1"><img src="https://s1.ax1x.com/2022/03/18/qkuZA1.md.png" alt="qkuZA1.md.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkuOgO"><img src="https://s1.ax1x.com/2022/03/18/qkuOgO.png" alt="qkuOgO.png"></a></p>
<h3 id="默认子网掩码">默认子网掩码</h3>
<p>默认子网掩码是指在未划分子网的情况下使用的子网掩码</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkMEJx"><img src="https://s1.ax1x.com/2022/03/18/qkMEJx.md.png" alt="qkMEJx.md.png"></a></p>
<h2 id="无分类编址的IPv4地址">无分类编址的IPv4地址</h2>
<p>划分子网在一定程度上缓解了因特网在发展中遇到的困难，但是<strong>数量巨大的C类网</strong>因为其<strong>地址空间太小</strong>并<strong>没有得到充分使用</strong>，而因特网的IP地址仍在加速消耗，整个<strong>IPv4地址空间面临全部耗尽的威胁</strong>。</p>
<p>为此，因特网工程任务组IETF又提出了采用<strong>无分类编址</strong>的方法来解决IP地址紧张的问题，同时还专门成立IPv6工作组负责研究新版本IP以彻底解决IP地址耗尽问题。</p>
<p>1993年，IETF发布了<strong>无分类域间路由选择CIDR</strong>（Classless Inter-Domain Routing）的RFC文档：RFC 1517~1519和1520。</p>
<ul>
<li><strong>CIDR消除了传统的A类、B类和C类地址，以及划分子网的概念</strong>；</li>
<li><strong>CIDR可以更加有效地分配IPv4的地址空间</strong>，并且可以在新的IPv6使用之前允许因特网的规模继续增长。</li>
</ul>
<p>CIDR使用“<strong>斜线记法</strong>”，或称CIDR记法。即在IPv4地址后面加上斜线“/”，在<strong>斜线后面写上网络前缀所占的比特数量</strong>。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qk35DO"><img src="https://s1.ax1x.com/2022/03/18/qk35DO.md.png" alt="qk35DO.md.png"></a></p>
<p>CIDR实际上是<strong>将网络前缀都相同的连续的IP地址组成一个“CIDR地址块”</strong>。</p>
<h3 id="CIDR地址块细节">CIDR地址块细节</h3>
<p>我们只要知道CIDR地址块中的任何一个地址，就可以知道该地址块的全部细节：</p>
<ul>
<li>地址块的最小地址</li>
<li>地址块的最大地址</li>
<li>地址块中的地址数量</li>
<li>地址块聚合某类网络（A类、B类或C类）的数量地址掩码（也可继续称为子网掩码）</li>
</ul>
<p>例如对于CIDR地址块<strong>128.14.35.7/20</strong></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qk8XFJ"><img src="https://s1.ax1x.com/2022/03/18/qk8XFJ.png" alt="qk8XFJ.png"></a></p>
<h3 id="路由聚合（构造超网）">路由聚合（构造超网）</h3>
<p>保留共同前缀，后面都取0，再加上“/共同前缀长度”，即为聚合地址块。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkJxr6"><img src="https://s1.ax1x.com/2022/03/18/qkJxr6.png" alt="qkJxr6.png"></a></p>
<p><strong>网络前缀越长，地址块越小，路由越具体</strong>；</p>
<p>若路由器查表转发分组时发现有多条路由可选，则选择网络前缀最长的那条，这称为<strong>最长前缀匹配</strong>，因为这样的路由更具体。</p>
<h2 id="IPv4地址的应用规划">IPv4地址的应用规划</h2>
<h3 id="定长的子网掩码FLSM（Fixed-Length-Subnet-Mask）">定长的子网掩码FLSM（Fixed Length Subnet Mask）</h3>
<ul>
<li>使用<strong>同一个子网掩码</strong>来划分子网</li>
<li>子网<strong>划分方式不灵活</strong>：只能划分出2^n个子网（n是从主机号部分借用的用来作为子网号的比特数量）</li>
<li>每个子网所<strong>分配的IP地址数量相同</strong>，容易造成<strong>IP地址浪费</strong>。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qka69e"><img src="https://s1.ax1x.com/2022/03/18/qka69e.png" alt="qka69e.png"></a></p>
<h3 id="变长的子网掩码VLSM（Variable-Length-Subnet-Mask）">变长的子网掩码VLSM（Variable Length Subnet Mask）</h3>
<ul>
<li>使用<strong>不同的子网掩码</strong>来划分子网</li>
<li>子网<strong>划分方式灵活</strong>：可以<strong>按需分配</strong></li>
<li>每个子网所<strong>分配的IP地址数量可以不同</strong>，尽可能<strong>减少对IP地址的浪费</strong>。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qkaQ00"><img src="https://s1.ax1x.com/2022/03/18/qkaQ00.png" alt="qkaQ00.png"></a></p>
<h1>IP数据报的发送和转发过程</h1>
<p>IP数据报的发送和转发过程包含以下两部分：</p>
<ul>
<li>主机发送IP数据报</li>
<li>路由器转发IP数据报</li>
</ul>
<h2 id="主机发送IP数据报">主机发送IP数据报</h2>
<ul>
<li>若在同一个网络，则属于直接交付；</li>
<li>若不在同一个网络，则属于间接交付，传输给主机所在网络的默认网关（路由器），由默认网关帮忙转发；</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qAxKCn"><img src="https://s1.ax1x.com/2022/03/19/qAxKCn.md.png" alt="qAxKCn.md.png"></a></p>
<h3 id="源主机判断目的主机是否与自己在同一网络">源主机判断目的主机是否与自己在同一网络</h3>
<p>将目的IP地址与自身掩码相与，与自身IP地址与自身掩码相与的结果作对比，若不相等则不在同一网络中，为间接交付。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qAzkGR"><img src="https://s1.ax1x.com/2022/03/19/qAzkGR.md.png" alt="qAzkGR.md.png"></a></p>
<h3 id="源主机判断间接交付所用路由器">源主机判断间接交付所用路由器</h3>
<p>当本网络中主机要与其他网络中主机进行通信时，会将IP数据报传输给默认网关，由默认网关将IP数据报转发出去。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qESzEF"><img src="https://s1.ax1x.com/2022/03/19/qESzEF.md.png" alt="qESzEF.md.png"></a></p>
<h2 id="路由器转发IP数据报">路由器转发IP数据报</h2>
<ol>
<li>检查IP数据报首部是否出错：
<ul>
<li>若出错，则直接丢弃该IP数据报并通告源主机；</li>
<li>若没有出错，则进行转发；</li>
</ul>
</li>
<li>根据IP数据报的目的地址在路由表中查找匹配的条目
<ul>
<li>若找到匹配的条目，则转发给条目中指示的下一跳；</li>
<li>若找不到，则丢弃该IP数据报并通告源主机；</li>
</ul>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qE9es0"><img src="https://s1.ax1x.com/2022/03/19/qE9es0.md.png" alt="qE9es0.md.png"></a></p>
<p>路由器不对广播数据报进行转发，是隔离广播域的</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qE9WTS"><img src="https://s1.ax1x.com/2022/03/19/qE9WTS.md.png" alt="qE9WTS.md.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEEqgg"><img src="https://s1.ax1x.com/2022/03/19/qEEqgg.md.png" alt="qEEqgg.md.png"></a></p>
<h1>静态路由配置及其可能产生的路由环路问题</h1>
<ul>
<li>静态路由配置是指用户或网络管理员使用路由器的相关命令给路由器<strong>人工配置路由表</strong>。
<ul>
<li>这种人工配置方式简单、开销小。但<strong>不能及时适应网络状态（流量、拓扑等）的变化</strong>。</li>
<li>一般只在小规模网络中采用。</li>
</ul>
</li>
<li>使用静态路由配置可能出现以下导致产生路由环路的错误
<ul>
<li>配置错误</li>
<li>聚合了不存在的网络</li>
<li>网络故障</li>
</ul>
</li>
</ul>
<h2 id="静态路由配置">静态路由配置</h2>
<p>对于如下网络，由于路由器接口与网络直连，可以直接将网络及其接口加入路由表，类型属于直连。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEAFiT"><img src="https://s1.ax1x.com/2022/03/19/qEAFiT.md.png" alt="qEAFiT.md.png"></a></p>
<p>假设R1要发送数据报到192.168.2.0/24网络中的某个主机，应该将数据报转发给R2的接口0，但R1的路由表中并没有关于该目的网络的路由条目，即R1并不知道目的网络的存在。因此，可以使用路由器相关的配置命令，给R1添加一条到达该目的网络的路由条目。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEA2mn"><img src="https://s1.ax1x.com/2022/03/19/qEA2mn.md.png" alt="qEA2mn.md.png"></a></p>
<p>同理如下：</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEA76J"><img src="https://s1.ax1x.com/2022/03/19/qEA76J.md.png" alt="qEA76J.md.png"></a></p>
<h2 id="默认路由">默认路由</h2>
<p>假设R1要转发一个IP数据报给因特网中某个网络中的某个主机，从图中可以看出，R1应该将该IP数据报转发给路由器R2的接口0.由于因特网中包含了众多的网络，如果我们给R1添加针对这些网络的每一条路由条目，则会给人工配置带来巨大的工作量，并且使R1的路由表变得非常大，降低了查表转发的速度。</p>
<p>实际上，对于具有相同下一跳的不同目的网络的路由条目，我们可以用一条默认路由条目来替代。默认路由条目中的目的网络地址为0.0.0.0，地址掩码也为0.0.0.0，CIDR形式为0.0.0.0/0。对于本例，默认路由条目中的下一跳是路由器R2的接口0的地址。由于默认路由也是由人工配置的，因此其类型也为静态。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEesNq"><img src="https://s1.ax1x.com/2022/03/19/qEesNq.md.png" alt="qEesNq.md.png"></a></p>
<h2 id="特定主机路由">特定主机路由</h2>
<p>有时候，我们可以给路由器添加针对某个主机的特定主机路由条目。一般用于网络管理人员对网络的管理和测试。另外，在需要考虑某种安全问题时，也可以采用特定主机路由。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEmlxU"><img src="https://s1.ax1x.com/2022/03/19/qEmlxU.md.png" alt="qEmlxU.md.png"></a></p>
<h2 id="静态路由配置错误导致路由环路">静态路由配置错误导致路由环路</h2>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEmOJ0"><img src="https://s1.ax1x.com/2022/03/19/qEmOJ0.md.png" alt="qEmOJ0.md.png"></a></p>
<p>为了<strong>防止IP数据报在路由环路中永久兜圈</strong>，在IP数据报首部设有<strong>生存时间TTL</strong>字段。IP数据报进入路由器后，TTL字段的值减1。若TTL的值不等于0，则被路由器转发，否则被丢弃。</p>
<h2 id="聚合不存在网络而导致路由环路">聚合不存在网络而导致路由环路</h2>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEu9c8"><img src="https://s1.ax1x.com/2022/03/19/qEu9c8.md.png" alt="qEu9c8.md.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEuIEj"><img src="https://s1.ax1x.com/2022/03/19/qEuIEj.md.png" alt="qEuIEj.md.png"></a></p>
<p>针对这种情况，可以添加针对所聚合的、不存在的网络的黑洞路由。黑洞路由的下一跳为null0，这是路由器内部的虚拟接口，数据报进入该虚拟接口后路由器会将其丢弃（就像个黑洞，有去无回的那种</p>
<p>对于下例，根据最长前缀匹配原则，IP数据报就会直接进入黑洞</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEKVqe"><img src="https://s1.ax1x.com/2022/03/19/qEKVqe.md.png" alt="qEKVqe.md.png"></a></p>
<h2 id="网络故障而导致路由环路">网络故障而导致路由环路</h2>
<p>假设路由器R1检测到其接口0所直连的网络出现了故障而不可达，就会自动在其路由表中删除其直连网络的路由条目。之后R2要转发IP数据报到该网络，从而导致路由环路。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEM9eg"><img src="https://s1.ax1x.com/2022/03/19/qEM9eg.md.png" alt="qEM9eg.md.png"></a></p>
<p>针对这种情况，可以在R1的路由表中添加针对该直连网络的黑洞路由。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEQLxP"><img src="https://s1.ax1x.com/2022/03/19/qEQLxP.md.png" alt="qEQLxP.md.png"></a></p>
<p>假设过一段时间后故障消失，黑洞路由就会自动失效，路由器自动添加针对该直连网络的路由条目。如果再次出现故障，则路由器自动删除针对该直连网络的路由条目，黑洞路由也会自动生效。<s>于是只有路由器受伤的世界完成了</s></p>
<h1>路由选择协议</h1>
<h2 id="路由选择协议概述">路由选择协议概述</h2>
<h3 id="静态路由选择：">静态路由选择：</h3>
<ul>
<li>由<strong>人工配置</strong>的网络路由、默认路由、特定主机路由、黑洞路由等都属于静态路由。</li>
<li>这种人工配置方式简单、开销小。但<strong>不能及时适应网络状态（流量、拓扑等）的变化</strong>。</li>
<li>一般只在<strong>小规模网络</strong>中采用。</li>
</ul>
<h3 id="动态路由选择：">动态路由选择：</h3>
<ul>
<li>路由器通过路由选择协议<strong>自动获取路由信息</strong>。</li>
<li>比较复杂、开销比较大。<strong>能较好地适应网络状态的变化</strong>。</li>
<li>适用于<strong>大规模网络</strong>。</li>
</ul>
<h3 id="因特网所采用的路由选择协议的主要特点：">因特网所采用的路由选择协议的主要特点：</h3>
<p><strong>自适应</strong>：动态路由选择，能较好地适应网络状态的变化<br>
<strong>分布式</strong>：路由器之间交换路由信息<br>
<strong>分层次</strong>：将整个因特网划分为许多较小的自治系统AS（Autonomous System）</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEJzZV"><img src="https://s1.ax1x.com/2022/03/19/qEJzZV.md.png" alt="qEJzZV.md.png"></a></p>
<h3 id="常见的路由选择协议：">常见的路由选择协议：</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEJTIS"><img src="https://s1.ax1x.com/2022/03/19/qEJTIS.md.png" alt="qEJTIS.md.png"></a></p>
<h3 id="路由器的基本结构">路由器的基本结构</h3>
<p>路由器是一种具有多个输入端口和输出端口的专用计算机，其任务是转发分组。</p>
<p>路由器结构可以划分为两大部分，一个是<strong>路由选择部分</strong>，另一个是<strong>分组转发部分</strong>。</p>
<p>路由选择部分的核心构件是<strong>路由选择处理机</strong>，它的任务是根据所使用的路由选择协议，周期性地与其他路由器进行路由信息的交互来更新路由表。</p>
<p>分组转发部分由三部分构成，分别是交换结构、一组输入端口和一组输出端口。信号从某个输入端口进入路由器，物理层将信号转换成比特流送交数据链路层处理。数据链路层从比特流中识别出帧，去掉帧头和帧尾后送交网络层处理。</p>
<p>如果送交网络层的分组是<strong>普通待转发的数据分组</strong>，则根据分组首部中的目的地址进行<strong>查表转发</strong>，若找不到匹配的转发条目，则丢弃该分组；否则按照匹配条目中所指示的端口进行转发。网络层更新数据分组首部中某些字段的值，例如将数据分组的生存时间减1。然后送交数据链路层进行封装。数据链路层将数据分组封装成帧，送交物理层处理。物理层将帧看作是比特流，将其变换成相应的电信号进行发送。</p>
<p>如果送交网络层的分组是路由器之间交换路由信息的<strong>路由报文</strong>，则把这种分组<strong>送交路由选择处理机</strong>，路由选择处理机根据分组的内容，来更新自己的路由表。路由表一般仅包含<strong>从目的网络到下一跳的映射</strong>，路由表需要对网络拓扑变化的计算最优化。而转发表是从路由表得出的，转发表的结构应当使查找过程最优化。</p>
<p>路由选择处理机除了处理收到的路由报文外，还会<strong>周期性地给其他路由器发送自己所知道的路由信息</strong>。路由器的各端口还应具有输入缓冲区和输出缓冲区。输入缓冲区用来暂存新进入路由器但还来不及处理的分组，输出缓冲区用来暂存已经处理完毕，但还来不及发送的分组。需要说明的是，路由器的端口一般都具有输入和输出的功能，我们图中分别给出输入端口和输出端口目的在于更好地演示路由器的基本工作过程。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEUpIf"><img src="https://s1.ax1x.com/2022/03/19/qEUpIf.md.png" alt="qEUpIf.md.png"></a></p>
<h2 id="路由信息协议RIP（Routing-Information-Protocol）">路由信息协议RIP（Routing Information Protocol）</h2>
<p>RIP要求自治系统AS内的每一个路由器都要维护从它自己到AS内其他每一个网络的距离记录。这是一组距离，称为“<strong>距离向量D-V（Distance-Vector）</strong>”。</p>
<p>RIP使用<strong>跳数</strong>（Hop Count）作为度量（Metric）来衡量到达目的网络的距离。</p>
<ul>
<li>路由器到直连网络的距离定义为1。</li>
<li>路由器到非直连网络的距离定义为所经过的路由器数加1。口允许一条路径最多只能包含15个路由器。</li>
<li>“距离”等于16时相当于不可达。因此，RIP只适用于小型互联网。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qELPt1"><img src="https://s1.ax1x.com/2022/03/19/qELPt1.md.png" alt="qELPt1.md.png"></a></p>
<p>RIP认为好的路由就是“<strong>距离短</strong>”的路由，也就是<strong>所通过路由器数量最少的路由</strong>。当到达同一目的网络有多条“距离相等”的路由时，可以进行<strong>等价负载均衡</strong>。</p>
<p>RIP包含以下三个要点：</p>
<ul>
<li>和谁交换信息：仅和<strong>相邻路由器</strong>交换信息</li>
<li>交换什么信息：自己的<strong>路由表</strong></li>
<li>何时交换信息：<strong>周期性交换</strong>（例如每30秒）</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEODIA"><img src="https://s1.ax1x.com/2022/03/19/qEODIA.md.png" alt="qEODIA.md.png"></a></p>
<h3 id="RIP的基本工作过程">RIP的基本工作过程</h3>
<ol>
<li>
<p>路由器刚开始工作时，<strong>只知道自己到直连网络的距离为1</strong>。</p>
</li>
<li>
<p>每个路由器仅<strong>和相邻路由器周期性地交换并更新路由信息</strong>。</p>
</li>
<li>
<p>若干次交换和更新后，<strong>每个路由器都知道到达本AS内各网络的最短距离和下一跳地址</strong>，称为收敛。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qEjB9I"><img src="https://s1.ax1x.com/2022/03/19/qEjB9I.md.png" alt="qEjB9I.md.png"></a></p>
<h3 id="RIP的路由条目更新规则">RIP的路由条目更新规则</h3>
<p>路由器C和D互为相邻路由器，它们之间周期性地交换并更新路由信息。路由器C的路由表中到达各目的网络的下一跳都记为问号，可以理解为路由器D并不需要关心路由器C的这些内容。</p>
<p>假设路由器C的RIP更新报文发送周期到了，则路由器C将自己路由表中的相关路由信息封装到RIP更新报文中发送给路由器D。我们可以简单地理解为路由器C将自己的路由表发送给了路由器D。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVp1O0"><img src="https://s1.ax1x.com/2022/03/19/qVp1O0.md.png" alt="qVp1O0.md.png"></a></p>
<p>路由器D收到后对其进行改造，将到达各目的网络的下一跳都改为C，距离都增加1。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVpBOx"><img src="https://s1.ax1x.com/2022/03/19/qVpBOx.md.png" alt="qVpBOx.md.png"></a></p>
<p>现在路由器D根据改造的路由表来更新自己的路由表，更新规则如下图。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVpnYQ"><img src="https://s1.ax1x.com/2022/03/19/qVpnYQ.md.png" alt="qVpnYQ.md.png"></a></p>
<h3 id="“坏消息传得慢”的问题">“坏消息传得慢”的问题</h3>
<p>RIP存在“<strong>坏消息传播得慢</strong>”的问题。“坏消息传播得慢”又称为<strong>路由环路</strong>或<strong>距离无穷计数问题</strong>，这是<strong>距离向量算法的一个固有问题</strong>。</p>
<p>如图所示，假设R1到达其直连网络的链路出现了故障，当R1检测出该故障后会将到达N1的路由条目中的距离修改为16，表示N1不可达。并等待RIP更新周期到时后发送该路由信息给R2。而此时R2的路由表中关于N1的路由条目仍然是先前通过RIP协议获取到的，也就是到达N1的距离为2，下一跳通过R1转发。</p>
<p>假设R2的RIP更新周期先到时，也就是R2的这条路由信息先到达R1，而R1的这条路由信息后到达R2。当R1收到R2的路由信息后，就会被该谣言误导，认为可以通过R2到达N1，距离为3，并在自己的RIP更新信息到时后，发送给R2。如此循环往复，直到R1和R2的路由表中到达N1的路由条目的距离都增加到16后，R1和R2才知道N1不可达（收敛）。在此过程中，R1和R2之间会出现<strong>路由环路</strong>，时间长达数分钟。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVitD1"><img src="https://s1.ax1x.com/2022/03/19/qVitD1.md.png" alt="qVitD1.md.png"></a></p>
<p>可以采取多种措施<strong>减少</strong>出现该问题的概率或减小该问题带来的危害，但<strong>不能完全避免</strong>。</p>
<ul>
<li><strong>限制最大路径距离</strong>为15（16表示不可达）</li>
<li>当路由表发生变化时就立即发送更新报文（即“<strong>触发更新</strong>”），而不仅是周期性发送</li>
<li>让路由器记录收到某特定路由信息的接口，而不让同一路由信息再通过此接口向反方向传送（即“<strong>水平分割</strong>”）</li>
</ul>
<h2 id="开放最短路径优先OSFP（Open-Shortest-Path-First）的基本工作原理">开放最短路径优先OSFP（Open Shortest Path First）的基本工作原理</h2>
<ul>
<li>
<p>开放最短路径优先OSPF（Open Shortest Path First），是为克服RIP的缺点在1989年开发出来的。</p>
<ul>
<li>“开放”表明OSPF协议不是受某一家厂商控制，而是<strong>公开发表</strong>的。</li>
<li>“最短路径优先”是因为使用了Dijkstra提出的<strong>最短路径算法</strong>SPF。</li>
</ul>
</li>
<li>
<p>OSPF是基于<strong>链路状态</strong>的，而不像RIP那样是基于距离向量的。</p>
</li>
<li>
<p>OSPF采用SPF算法计算路由，从算法上保证了<strong>不会产生路由环路</strong>。</p>
</li>
<li>
<p>OSPF<strong>不限制网络规模</strong>，更新效率高，<strong>收敛速度快</strong>。</p>
</li>
<li>
<p>链路状态是指本路由器都<strong>和哪些路由器相邻</strong>，以及相应<strong>链路的“代价”</strong>（cost）。</p>
<ul>
<li>“代价”用来表示费用、距离、时延、带宽，等等。这些都由网络管理人员来决定。</li>
<li><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVAvPf"><img src="https://s1.ax1x.com/2022/03/19/qVAvPf.md.png" alt="qVAvPf.md.png"></a></li>
</ul>
</li>
</ul>
<h3 id="OSPF中的邻居关系">OSPF中的邻居关系</h3>
<ul>
<li>OSPF相邻路由器之间通过交互<strong>问候（Hello）分组</strong>，建立和维护<strong>邻居关系</strong>。
<ul>
<li>Hello分组封装在IP数据报中，发往组播地址224.0.0.5；</li>
<li><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVEjm9"><img src="https://s1.ax1x.com/2022/03/19/qVEjm9.md.png" alt="qVEjm9.md.png"></a></li>
<li>发送周期为10秒</li>
<li>40秒未收到来自邻居路由器的Hello分组，则认为该邻居路由器不可达。</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVVmkt"><img src="https://s1.ax1x.com/2022/03/19/qVVmkt.md.png" alt="qVVmkt.md.png"></a></p>
<h3 id="OSPF的LSA和LSU">OSPF的LSA和LSU</h3>
<ul>
<li>使用OSPF的每个路由器都会产生<strong>链路状态通告LSA</strong>（Link State Advertisement）。LSA中包含以下内容：
<ul>
<li>直连网络的链路状态信息</li>
<li>邻居路由器的链路状态信息</li>
</ul>
</li>
<li>LSA被封装在<strong>链路状态更新分组LSU</strong>中，采用<strong>洪泛法</strong>发送，也就是进行洪泛转发。这样，自治系统中每个路由器所发送的封装有链路状态通告的链路状态更新分组会传递给系统中其他所有路由器。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVZEgU"><img src="https://s1.ax1x.com/2022/03/19/qVZEgU.md.png" alt="qVZEgU.md.png"></a></p>
<h3 id="OSPF的LDB">OSPF的LDB</h3>
<ul>
<li>使用OSPF的每个路由器都有一个<strong>链路状态数据库LSDB</strong>，用于存储LSA。</li>
<li>通过各路由器洪泛发送封装有自己LSA的LSU分组，各路由器的LSDB最终将达到一致。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVZr28"><img src="https://s1.ax1x.com/2022/03/19/qVZr28.md.png" alt="qVZr28.md.png"></a></p>
<h3 id="OSPF中最短路径的获取">OSPF中最短路径的获取</h3>
<p>使用OSPF的各路由器<strong>基于LSDB进行最短路径优先SPF计算</strong>，构建出各自到达其他各路由器的最短路径，即构建各自的路由表。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVnaVJ"><img src="https://s1.ax1x.com/2022/03/19/qVnaVJ.md.png" alt="qVnaVJ.md.png"></a></p>
<h3 id="OSPF的分组类型">OSPF的分组类型</h3>
<ul>
<li>OSPF有以下五种分组类型：
<ul>
<li><strong>问候</strong>（Hello）分组：用来发现和维护邻居路由器的可达性。</li>
<li><strong>数据库描述</strong>（Database Description）分组：向邻居路由器给出自己的链路状态数据库中的所有链路状态项目的摘要信息</li>
<li><strong>链路状态请求</strong>（Link State Request）分组：向邻居路由器请求发送某些链路状态项目的详细信息。</li>
<li><strong>链路状态更新</strong>（Link State Update）分组：路由器使用这种分组将其链路状态进行洪泛发送，即用洪泛法对全网更新链路状态。</li>
<li><strong>链路状态确认</strong>（Link State Acknowledgment）分组：这是对链路状态更新分组的确认分组。</li>
</ul>
</li>
</ul>
<h3 id="OSPF的基本工作过程">OSPF的基本工作过程</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVKtAJ"><img src="https://s1.ax1x.com/2022/03/19/qVKtAJ.md.png" alt="qVKtAJ.md.png"></a></p>
<h3 id="OSPF在多点接入网络中路由器邻居关系的建立">OSPF在多点接入网络中路由器邻居关系的建立</h3>
<ul>
<li>当OSPF路由器在多点接入网络中建立邻居关系时，如果不采用其他机制，将会产生大量的多播分组。
<ul>
<li>为了减少所发送分组的数量，OSPF选举<strong>指定路由器DR</strong>（designated router）和<strong>备用的指定路由器BDR</strong>（backup designated router）</li>
<li><strong>所有的非DR/BDR只与DR/BDR建立邻居关系</strong></li>
<li>非DR/BDR之间通过DR/BDR交换信息</li>
<li>当DR出现故障，则由BDR顶替DR</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVM4i9"><img src="https://s1.ax1x.com/2022/03/19/qVM4i9.md.png" alt="qVM4i9.md.png"></a></p>
<h3 id="OSPF分层次划分区域">OSPF分层次划分区域</h3>
<p>为了使OSPF能够用于规模很大的网络，OSPF把一个自治系统再划分为若干个更小的范围，叫做<strong>区域</strong>（Area）</p>
<p>如图所示，这是一个规模很大的网络，我们将其划分成一个自治系统。在该自治系统内，所有路由器都使用OSPF协议。OSPF将该自治系统再划分成四个更小的区域。每个区域都有一个32比特的区域标识符，可以用点分十进制表示。例如，<strong>主干区域的标识符必须为0</strong>，也可以表示为点分十进制的0.0.0.0。主干区域用于连通其他区域，<strong>其他区域的标识符不能为0且互不相同</strong>。</p>
<p>每个区域的规模不应太大，一般所包含的路由器不应超过200个。划分区域的好处就是<strong>把利用洪泛法交换链路状态信息的范围局限于每一个区域</strong>，而不是整个自治系统，这样就<strong>减少了整个网络上的通信量</strong>。</p>
<p>如果路由器的所有接口都在同一个区域内，则该路由器称为<strong>区域内路由器</strong>。为了本区域可以和自治系统内的其他区域连通，每个区域都会有一个<strong>区域边界路由器</strong>，它的一个接口用于连接自身所在区域，另一个接口用于连接主干区域。主干区域内的路由器称为<strong>主干路由器</strong>。我们可以把区域边界路由器看作是主干路由器。在主干区域内还要有一个路由器，专门和本自治系统外的其他自治系统交换路由信息，这样的路由器称为<strong>自治系统边界路由器</strong>。</p>
<p>采用分层次划分区域的方法，虽然使<strong>交换信息的种类增多</strong>了，同时也<strong>使OSPF协议更加复杂</strong>了，但这样做却能<strong>使每一个区域内部交换路由信息的通信量大大减小</strong>，因而使OSPF协议能够用于规模很大的自治系统中。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qVQsFH"><img src="https://s1.ax1x.com/2022/03/19/qVQsFH.md.png" alt="qVQsFH.md.png"></a></p>
<h2 id="边界网关协议BGP（Border-Gateway-Protocol）">边界网关协议BGP（Border Gateway Protocol）</h2>
<ul>
<li>内部网关协议IGP（例如路由信息协议RIP或开放最短路径优先OSPF）
<ul>
<li>设法使分组在一个自治系统内尽可能有效地从源网络传输到目的网络</li>
<li>无需考虑自治系统外部其他方面的策略</li>
</ul>
</li>
<li>外部网关协议EGP（例如边界网关协议BGP）
<ul>
<li>在不同自治系统内，度量路由的“代价”（距离，带宽，费用等）可能不同。因此，对于自治系统之间的路由选择，使用“代价”作为度量来寻找最佳路由是不行的。<br>
<a target="_blank" rel="noopener" href="https://imgtu.com/i/qV1LZT"><img src="https://s1.ax1x.com/2022/03/19/qV1LZT.md.png" alt="qV1LZT.md.png"></a></li>
<li>自治系统之间的路由选择必须考虑相关策略（政治，经济，安全等）<br>
<a target="_blank" rel="noopener" href="https://imgtu.com/i/qV3VFe"><img src="https://s1.ax1x.com/2022/03/19/qV3VFe.md.png" alt="qV3VFe.md.png"></a></li>
<li>BGP只能是力求寻找一条能够到达目的网络且比较好的路由（不能兜圈子），而并非要寻找一条最佳路由</li>
</ul>
</li>
</ul>
<h3 id="BGP发言人">BGP发言人</h3>
<ul>
<li>在配置BGP时，每个自治系统的管理员要选择至少一个路由器作为该自治系统的“<strong>BGP发言人</strong>”</li>
<li>不同自治系统的BGP发言人要交换路由信息，首先必须建立<strong>TCP连接</strong>，端口号为179
<ul>
<li>在此TCP连接上交换BGP报文以建立<strong>BGP会话</strong></li>
<li>利用BGP会话<strong>交换路由信息</strong>（例如，增加新的路由，或撤销过时的路由，以及报告出错的情况等）</li>
<li>使用TCP连接交换路由信息的两个BGP发言人，彼此称为对方的<strong>邻站</strong>（neighbor）或<strong>对等站</strong>（peer）</li>
</ul>
</li>
<li>BGP发言人除了运行BGP外，还必须运行自己所在自治系统所使用的内部网关协议IGP，例如OSPF或RIP。</li>
<li>BGP发言人<strong>交换网络可达性的信息</strong>（要到达某个网络所要经过的一系列自治系统）</li>
<li>当BGP发言人互相交换了网络可达性的信息后，各BGP发言人就根据所采用的策略从收到的路由信息中<strong>找出到达各自治系统的较好的路由</strong>。也就是构造出树形结构、<strong>不存在回路的自治系统连通图</strong>。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qV3jnP"><img src="https://s1.ax1x.com/2022/03/19/qV3jnP.md.png" alt="qV3jnP.md.png"></a></p>
<h3 id="BGP发言人交换路径向量">BGP发言人交换路径向量</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qV8i1s"><img src="https://s1.ax1x.com/2022/03/19/qV8i1s.md.png" alt="qV8i1s.md.png"></a></p>
<h3 id="BGP-4的四种报文">BGP-4的四种报文</h3>
<ul>
<li><strong>OPEN（打开）报文</strong>：用来与相邻的另一个BGP发言人建立关系，使通信初始化。</li>
<li><strong>UPDATE（更新）报文</strong>：用来通告某一路由的信息，以及列出要撤销的多条路由。</li>
<li><strong>KEEPALIVE（保活）报文</strong>：用来周期性地证实邻站的连通性。</li>
<li><strong>NOTIFICATION（通知）报文</strong>：用来发送检测到的差错。</li>
</ul>
<p>在BGP协议刚刚运行时，BGP的邻站交换整个BGP路由表。但以后<strong>只需要在发生变化时更新有变化的部分</strong>，这样做对节省网络带宽和减少路由器的处理开销都有好处。</p>
<h2 id="RIP、OSPF、BGP的封装">RIP、OSPF、BGP的封装</h2>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qV8f3j"><img src="https://s1.ax1x.com/2022/03/19/qV8f3j.md.png" alt="qV8f3j.md.png"></a></p>
<h1>IPv4数据报的首部格式</h1>
<p>（以下IPv4数据报简称为IP数据报</p>
<p>如图所示，这是IP数据报的首部格式。它由20字节的固定部分和最大40字节的可变部分组成。所谓固定部分，是指每个IP数据报首部都必须包含的部分。而某些IP数据报的首部，除了包含20字节的固定部分外，还包含一些可选的字段来增加IP数据报的功能。IP数据报的首部常以32个比特为单位进行描述。图中的每一行都由32个比特（四个字节）构成，每个小格子称为字段或域。每个字段或某些字段的组合用来表达IP协议的相关功能。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZnTXT"><img src="https://s1.ax1x.com/2022/03/20/qZnTXT.md.png" alt="qZnTXT.md.png"></a></p>
<h2 id="版本、首部长度、区分服务、总长度字段">版本、首部长度、区分服务、总长度字段</h2>
<ul>
<li>
<p>版本：<br>
占4比特，表示IP协议的版本。<br>
通信双方使用的IP协议的版本必须一致。目前广泛使用的IP协议版本号为4（即IPv4）。</p>
</li>
<li>
<p>首部长度：<br>
占4比特，表示IP数据报首部的长度。<br>
该字段的取值以4字节为单位。最小十进制取值为5，表示IP数据报首部只有20字节固定部分；<br>
最大十进制取值为15，表示IP数据报首部包含20字节固定部分和最大40字节可变部分。</p>
</li>
<li>
<p>区分服务<br>
占8比特，用来获得更好的服务。<br>
该字段在旧标准中叫作服务类型，但实际上一直没有被使用过。<br>
1998年，因特网工程任务组IETF把这个字段改名为区分服务。<br>
利用该字段的不同数值可提供不同等级的服务质量。<br>
只有在使用区分服务时，该字段才起作用。一般情况下都不使用该字段。</p>
</li>
<li>
<p>总长度<br>
占16比特，表示IP数据报的总长度（首部＋数据载荷）。<br>
最大取值为十进制的65535，以字节为单位。</p>
</li>
</ul>
<h2 id="标识、标志、片偏移字段">标识、标志、片偏移字段</h2>
<p>这三个字段共同用于IP数据报的分片。例如对于网际层封装出的IP数据报，它将在数据链路层封装成帧，每一种数据链路层协议都规定了帧的数据载荷的最大长度，称为最大传输单元MTU。例如，以太网的数据链路层规定MTU的值为1500个字节，如果某个IP数据报的总长度超过MTU时，将无法封装成帧。需要将原IP数据报分片为更小的IP数据报，再将各分片IP数据报封装成帧。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZKjQx"><img src="https://s1.ax1x.com/2022/03/20/qZKjQx.md.png" alt="qZKjQx.md.png"></a></p>
<ul>
<li>
<p>标识<br>
占16比特，属于同一个数据报的各分片数据报应该具有相同的标识。<br>
IP软件维持一个计数器，每产生一个数据报，计数器值加1，并将此值赋给标识字段。</p>
</li>
<li>
<p>标志<br>
占3比特，各比特含义如下：</p>
<ul>
<li>DF位：
<ul>
<li>1表示不允许分片；</li>
<li>0表示允许分片</li>
</ul>
</li>
<li>MF位：
<ul>
<li>1表示“后面还有分片”：</li>
<li>0表示“这是最后一个分片”</li>
</ul>
</li>
<li>保留位：必须为0</li>
</ul>
</li>
<li>
<p>片偏移<br>
占13比特，指出分片数据报的数据载荷部分偏移其在原数据报的位置有多少个单位。<br>
片偏移以8个字节为单位。<br>
片偏移量必须为整数</p>
</li>
</ul>
<h3 id="分片举例">分片举例</h3>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZlCRA"><img src="https://s1.ax1x.com/2022/03/20/qZlCRA.md.png" alt="qZlCRA.md.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZlNi4"><img src="https://s1.ax1x.com/2022/03/20/qZlNi4.md.png" alt="qZlNi4.md.png"></a></p>
<h2 id="生存时间、协议、首部检验和字段">生存时间、协议、首部检验和字段</h2>
<ul>
<li>
<p>生存时间TTL<br>
占8比特，最初以秒为单位，最大生存周期为255秒<br>
路由器转发IP数据报时，将IP数据报首部中的该字段的值减去IP数据报在本路由器上所耗费的时间，若不为0就转发，否则就丢弃。<br>
现在以“跳数”为单位，路由器转发IP数据报时，将IP数据报首部中的该字段的值减1，若不为0就转发，否则就丢弃。<br>
生存时间TTL字段可以防止IP数据报在网络中永久兜圈<br>
<a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ1I39"><img src="https://s1.ax1x.com/2022/03/20/qZ1I39.md.png" alt="qZ1I39.md.png"></a></p>
</li>
<li>
<p>协议<br>
占8比特，指明IPv4数据报的数据部分是何种协议数据单元。<br>
常用的一些协议和相应的协议字段值如下<br>
|协议名称|ICMP|IGMP|TCP|UDP|IPv6|OSPF|<br>
|—|—|—|—|—|—|—|<br>
|协议字段值|1|2|6|17|41|89|</p>
</li>
<li>
<p>首部检验和<br>
占16比特，用来检测首部在传输过程中是否出现差错。比CRC检验码简单，称为因特网检验和。<br>
IP数据报每经过一个路由器，路由器都要重新计算首部检验和，因为某些字段（生存时间、标志、片偏移等）的取值可能发生变化。<br>
由于IP层本身并不提供可靠传输的服务，并且计算首部校验和是一项耗时的操作，因此在IPv6中，路由器不再计算首部校验和，从而更快转发IP数据报。</p>
</li>
</ul>
<h2 id="源IP地址、目的IP地址字段">源IP地址、目的IP地址字段</h2>
<p>各占32比特，用来填写发送该IP数据报的源主机的IP地址和接收该IP数据报的目的主机的IP地址。</p>
<h2 id="可选、填充字段">可选、填充字段</h2>
<ul>
<li>可选字段<br>
长度从1个字节到40个字节不等。用来支持排错、测量及安全等措施。<br>
可选字段增加了IP数据报的功能，但这同时也使得IP数据报的首部长度成为可变的。这就增加了每一个路由器处理IP数据报的开销。实际上可选字段很少被使用。</li>
<li>填充字段<br>
确保首部长度为4字节的整数倍。使用全0进行填充。</li>
</ul>
<h1>网际控制报文协议ICMP（Internet Control Message Protocol）</h1>
<ul>
<li>为了更有效地转发IP数据报和提高交付成功的机会，在网际层使用了网际控制报文协议ICMP（Internet Control Message Protocol）。</li>
<li>主机或路由器使用ICMP来发送<strong>差错报告报文</strong>和<strong>询问报文</strong>。</li>
<li><strong>ICMP报文被封装在IP数据报</strong>中发送。</li>
</ul>
<h2 id="ICMP差错报告报文">ICMP差错报告报文</h2>
<p>ICMP差错报告报文有以下五种：</p>
<ul>
<li>终点不可达</li>
<li>源点抑制</li>
<li>时间超过</li>
<li>参数问题</li>
<li>改变路由（重定向）</li>
</ul>
<h3 id="终点不可达">终点不可达</h3>
<p>当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。具体可再根据ICMP的代码字段细分为目的网络不可达目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZU3Lj"><img src="https://s1.ax1x.com/2022/03/20/qZU3Lj.md.png" alt="qZU3Lj.md.png"></a></p>
<h3 id="源点抑制">源点抑制</h3>
<p>当路由器或主机由于拥塞而丢奔数据报时，就向源点发送源点抑制报文，使源点知道应当把数据报的发送速率放慢。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZUywR"><img src="https://s1.ax1x.com/2022/03/20/qZUywR.md.png" alt="qZUywR.md.png"></a></p>
<h3 id="时间超过">时间超过</h3>
<p>当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减1。</p>
<p>若结果不为0，则将该IP数据报转发出去；若结果为0，除丢奔该IP数据报外，还要向源点发送时间超过报文。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZaE1U"><img src="https://s1.ax1x.com/2022/03/20/qZaE1U.md.png" alt="qZaE1U.md.png"></a></p>
<p>另外，当终点在预先规定的时间内不能收到一个数据报的全部数据报片时，就把已收到的数据报片都丢弃，也会向源点发送时间超过报文。</p>
<h3 id="参数问题">参数问题</h3>
<p>当路由器或目的主机收到IP数据报后，根据其首部中的检验和字段发现首部在传输过程中出现了误码，就丢弃该数据报，并向源点发送参数问题报文。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZaj4x"><img src="https://s1.ax1x.com/2022/03/20/qZaj4x.md.png" alt="qZaj4x.md.png"></a></p>
<h3 id="改变路由（重定向）">改变路由（重定向）</h3>
<p>路由器把改变路由报文发送给主机，让主机知道下次应将数据报发送给另外的路由器（可通过更好的路由）。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZdnxS"><img src="https://s1.ax1x.com/2022/03/20/qZdnxS.md.png" alt="qZdnxS.md.png"></a></p>
<h3 id="不发送ICMP差错报告报文的情况">不发送ICMP差错报告报文的情况</h3>
<ul>
<li>对ICMP差错报告报文不再发送ICMP差错报告报文</li>
<li>对第一个分片的数据报片的所有后续数据报片都不发送ICMP差错报告报文</li>
<li>对具有多播地址的数据报都不发送ICMP差错报告报文</li>
<li>对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文</li>
</ul>
<h2 id="ICMP询问报文">ICMP询问报文</h2>
<p>常用的ICMP询问报文有以下两种：</p>
<ul>
<li>
<p>回送请求和回答<br>
ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问。<br>
收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文。<br>
这种询问报文用来<strong>测试目的站是否可达</strong>及了解其有关状态。</p>
</li>
<li>
<p>时间戳请求和回答<br>
ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间。<br>
在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。<br>
这种询问报文用来<strong>进行时钟同步和测量时间</strong>。</p>
</li>
</ul>
<h3 id="ICMP用于分组网间探测PING（Packet-InterNet-Groper）">ICMP用于分组网间探测PING（Packet InterNet Groper）</h3>
<ul>
<li>用来测试主机或路由器间的连通性</li>
<li>应用层直接使用网际层的ICMP（没有通过运输层的TCP或UDP）</li>
<li>使用ICMP回送请求和回答报文</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ0gDe"><img src="https://s1.ax1x.com/2022/03/20/qZ0gDe.md.png" alt="qZ0gDe.md.png"></a></p>
<p><s>（我那个破学校官网是怎么回事</s></p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ0j5n"><img src="https://s1.ax1x.com/2022/03/20/qZ0j5n.md.png" alt="qZ0j5n.md.png"></a></p>
<h3 id="ICMP用于跟踪路由（traceroute）">ICMP用于跟踪路由（traceroute）</h3>
<ul>
<li>用来测试IP数据报从源主机到达目的主机要经过哪些路由器</li>
<li>Windows版本
<ul>
<li>tracert命令</li>
<li>应用层直接使用网际层ICMP</li>
<li>使用了ICMP回送请求和回答报文以及差错报告报文</li>
</ul>
</li>
<li>Unix版本
<ul>
<li>traceroute命令</li>
<li>在运输层使用UDP协议</li>
<li>仅使用ICMP差错报告报文</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ0D9x"><img src="https://s1.ax1x.com/2022/03/20/qZ0D9x.md.png" alt="qZ0D9x.md.png"></a></p>
<h4 id="工作原理">工作原理</h4>
<p>假设主机H1想知道到达主机H2要经过哪些路由器。H1就给H2发送ICMP回送请求报文，该报文被封装在IP数据报中，IP数据报首部中生存时间字段TTL的值被设置为1。该IP数据报到达R1后，其生存时间减1结果为0。R1丢弃该数据报，并向发送该数据报的源主机H1发送ICMP差错报告报文，其类型为时间超过。</p>
<p>这样，H1就知道了到达H2的路径中的第一个路由器。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZBbz6"><img src="https://s1.ax1x.com/2022/03/20/qZBbz6.md.png" alt="qZBbz6.md.png"></a></p>
<p>H1继续发送下一个封装有ICMP回送请求报文的IP数据报，首部中生存时间字段TTL的值被设置为2。经过R1的转发后，该数据报的生存时间减少为1。该IP数据报到达R2后，其生存时间减一结果为0。R2丢弃该数据报，并向发送该数据报的源主机H1发送ICMP差错报告报文，其类型为时间超过。</p>
<p>这样，H1就知道了到达H2的路径中的第二个路由器。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZDQS0"><img src="https://s1.ax1x.com/2022/03/20/qZDQS0.md.png" alt="qZDQS0.md.png"></a></p>
<p>H1继续发送下一个封装有ICMP回送请求报文的IP数据报，首部中生存时间字段TTL的值被设置为3。经过R1、R2的转发后，该数据报到达主机H2，其生存时间减少为1。H2解析该数据报，发现其内部封装的是ICMP回送请求报文，于是就给H1发送封装有ICMP回送请求回答报文的IP数据报。</p>
<p>这样，H1就知道已经跟踪到路径中的最后一站，也就是目的主机H2。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZDNk9"><img src="https://s1.ax1x.com/2022/03/20/qZDNk9.md.png" alt="qZDNk9.md.png"></a></p>
<h1>虚拟专用网VPN与网络地址转换NAT</h1>
<h2 id="虚拟专用网VPN（Virtual-Private-Network）">虚拟专用网VPN（Virtual Private Network）</h2>
<p><strong>利用公用的因特网</strong>作为本机构各专用网之间的通信载体，这样的专用网又称为虚拟专用网。</p>
<p>由于IPv4地址的紧缺，一个机构能够申请到的IPv4地址数量往往远小于本机构所拥有的主机数量。因此，虚拟专用网中的各主机所分配的地址应该是本机构可自由分配的专用地址，而不是需要申请的、在因特网上使用的公有地址。</p>
<p>对于下图，给部门A分配的专用网分配的私有地址的网络号为10.1.0.0，给部门B的专用网分配的私有地址的网络号为10.2.0.0。两个专用网中各主机所分配的私有地址如图所示。需要注意的是，私有地址只能用于一个机构的内部通信，而不能用于和因特网上的主机通信。换句话说，私有地址只能用作本地地址，而不能用作全球地址。在因特网中的所有路由器，对目的地址是私有地址的IP数据报一律不进行转发。很显然，部门A和B各自至少需要一个路由器具有合法的全球IP地址，这样，它们各自的专用网才能利用公有的因特网进行通信。</p>
<p>假设部门A中一台主机要给部门B中的另一台主机发送数据，它会将待发送数据封装成内部IP数据报发送给路由器R1。其首部中源地址字段的值为部门A中该主机的IP地址，目的地址字段的值为部门B中另一台主机的IP地址。</p>
<p>R1收到该数据报后，发现其目的网络必须通过因特网才能到达，就将内部IP数据报进行加密，这样就确保了内部IP数据报的安全。然后重新添加上数据报的首部，封装成为在因特网上发送的外部数据报。其首部中源地址字段的值为路由器R1的全球地址，目的地址字段的值为路由器R2的全球地址。</p>
<p>路由器R2收到该外部IP数据报后，去掉其首部，将其数据部分进行解密，恢复出原来的IP数据报。这样就可以从其首部提取出源地址和目的地址。根据目的地址，将该内部IP数据报发送给相应的主机。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZRTFU"><img src="https://s1.ax1x.com/2022/03/20/qZRTFU.md.png" alt="qZRTFU.md.png"></a></p>
<p>很显然，两个专用网内的主机间发送的数据报是通过了公用的因特网，但在效果上就好像是在本机构的专用网上传送一样，数据报在因特网中可能要经过多个网络和路由器，但从逻辑上看，R1和R2之间好像是一条直通的点对点链路，因此也被称为IP隧道技术。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZfqq1"><img src="https://s1.ax1x.com/2022/03/20/qZfqq1.md.png" alt="qZfqq1.md.png"></a></p>
<ul>
<li>
<p>如上图所示，同一机构内不同部门的内部网络所构成的虚拟专用网VPN又称为<strong>内联网VPN</strong>。</p>
</li>
<li>
<p>有时一个机构的VPN需要有某些外部机构（通常就是合作伙伴）参加进来。这样的VPN就称为<strong>外联网VPN</strong>。</p>
</li>
<li>
<p>在外地工作的员工需要访问公司内部的专用网络时，只要在任何地点接入到因特网，运行驻留在员工PC中的VPN软件，在员工的PC和公司的主机之间建立VPN隧道，即可访问专用网络中的资源。这种VPN称为<strong>远程接入VPN</strong>。</p>
</li>
</ul>
<h2 id="网络地址转换NAT（Network-Address-Translation）">网络地址转换NAT（Network Address Translation）</h2>
<p>虽然因特网采用了无分类编址方式来减缓IPv4地址空间耗尽的速度，但由于因特网用户数目的激增，特别是大量小型办公室网络和家庭网络接入因特网的需求不断增加，IPv4地址空间即将面临耗尽的危险仍然没有被解除。</p>
<p>1994年提出了一种网络地址转换NAT的方法再次<strong>缓解了IPv4地址空间即将耗尽的问题</strong>。NAT能使<strong>大量使用内部专用地址的专用网络用户共享少量外部全球地址来访问因特网上的主机和资源</strong>。</p>
<p>对于下图，使用私有地址的主机要与因特网上使用全球IP地址的主机进行通信。这需要在专用网络连接到因特网的路由器上安装NAT软件，装有NAT软件的路由器叫做NAT路由器，它至少有一个有效的外部全球IP地址，这样，所有使用私有地址的主机在和外界通信时都要在NAT路由器上将其私有地址转换成全球IP地址。</p>
<p>假设使用私有地址的主机要给因特网上使用全球IP地址的另一台主机发送IP数据报。该主机将IP数据报发送给NAT路由器，数据报首部中源地址字段的值为该主机的私有地址，目的地址字段的值为因特网上另一台主机的全球地址。NAT路由器从自己的全球IP地址池中为该主机分配一个临时的全球IP地址172.38.1.5，并将IP数据报的源地址修改为该地址。然后将私有地址与全球地址的对应关系记录在NAT转换表中。之后就可以转发该IP数据报了。</p>
<p>请注意，此时该IP数据报中的源地址和目的地址都是全球IP地址。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZhcWD"><img src="https://s1.ax1x.com/2022/03/20/qZhcWD.md.png" alt="qZhcWD.md.png"></a></p>
<p>因特网上的这台主机给源主机发回数据报，数据报的源地址和目的地址都是全球IP地址。NAT路由器收到该IP数据报后，在NAT转换表中进行查找，发现该数据报的目的地址所对应的私有地址为192.168.0.2，于是就将该数据报的目的地址修改为192.168.0.2，并将其发送给相应的主机。</p>
<p>请注意，此时该IP数据报中的源地址为因特网上那台主机的全球IP地址，而目的地址为专用网络中这台主机的私有地址。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ43Xd"><img src="https://s1.ax1x.com/2022/03/20/qZ43Xd.md.png" alt="qZ43Xd.md.png"></a></p>
<p>当专用网中的这两台使用私有地址的主机，都要给因特网上使用全球地址的另一台主机发送数据报时，在NAT路由器的NAT转换表中就会产生两条记录，分别记录两个私有地址与两个全球地址的对应关系。这种基本转换方法存在一个问题：如果NAT路由器具有N个全球IP地址，那么至多只能由N个内网主机能够同时和因特网上的主机通信。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ4gA0"><img src="https://s1.ax1x.com/2022/03/20/qZ4gA0.md.png" alt="qZ4gA0.md.png"></a></p>
<p>由于绝大多数的网络应用都是使用运输层协议TCP或UDP来传送数据，因此可以利用运输层的端口号和IP地址一起进行转换。</p>
<p>这样，<strong>用一个全球IP地址就可以使多个拥有本地地址的主机同时和因特网上的主机进行通信</strong>。这种将端口号和IP地址一起进行转换的技术叫作<strong>网络地址与端口号转换NAPT</strong>（Network Address and Port Translation）。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZTyxU"><img src="https://s1.ax1x.com/2022/03/20/qZTyxU.md.png" alt="qZTyxU.md.png"></a></p>
<p>外网主机不可以首先对内网主机发起通信，因此内网主机不能直接充当因特网服务器。</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/qZ7nzT"><img src="https://s1.ax1x.com/2022/03/20/qZ7nzT.md.png" alt="qZ7nzT.md.png"></a></p>
<p>对于一些P2P网络应用，需要外网主机主动与内网主机进行通信，在通过NAT时会遇到问题，需要网络应用自己使用一些特殊的NAT穿越技术来解决问题。</p>
<p>另外，由于NAT对外网屏蔽了内网主机的网络地址，能为内网的主机提供一定的安全保护。</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2022/03/18/computerInternet-4/">计算机网络网课笔记-网络层</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Angie Lee</a></p>
        <p><span>Created:</span>2022-03-18, 16:29:48</p>
        <p><span>Updated:</span>2022-03-20, 16:39:29</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2022/03/18/computerInternet-4/" title="计算机网络网课笔记-网络层">https://angielee233.github.io/2022/03/18/computerInternet-4/</a>
            <span class="copy-path" data-clipboard-text="From https://angielee233.github.io/2022/03/18/computerInternet-4/　　By Angie Lee" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2022/03/20/computerInternet-5/">
                    计算机网络网课笔记-运输层
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2022/03/10/serializeAndDeserializeBinaryTree/">
                    二叉树的序列化与反序列化
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">网络层概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">网络层提供的两种服务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%99%9A%E7%94%B5%E8%B7%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.1.</span> <span class="toc-text">面向连接的虚电路服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.2.</span> <span class="toc-text">无连接的数据报服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF%E6%9C%8D%E5%8A%A1%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">2.3.</span> <span class="toc-text">虚电路服务与数据报服务的比较</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.</span> <span class="toc-text">分类编址的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A%E7%B1%BB%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.1.</span> <span class="toc-text">A类地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#B%E7%B1%BB%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.2.</span> <span class="toc-text">B类地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C%E7%B1%BB%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.3.</span> <span class="toc-text">C类地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ABC%E7%B1%BBIP%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%88%AB%E5%88%A4%E6%96%AD"><span class="toc-number">3.1.4.</span> <span class="toc-text">ABC类IP地址类别判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.5.</span> <span class="toc-text">特殊的IPv4地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">3.2.</span> <span class="toc-text">划分子网的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81"><span class="toc-number">3.2.1.</span> <span class="toc-text">子网掩码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86%E7%BB%86%E8%8A%82"><span class="toc-number">3.2.2.</span> <span class="toc-text">子网划分细节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81"><span class="toc-number">3.2.3.</span> <span class="toc-text">默认子网掩码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80%E7%9A%84IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">3.3.</span> <span class="toc-text">无分类编址的IPv4地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CIDR%E5%9C%B0%E5%9D%80%E5%9D%97%E7%BB%86%E8%8A%82"><span class="toc-number">3.3.1.</span> <span class="toc-text">CIDR地址块细节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%81%9A%E5%90%88%EF%BC%88%E6%9E%84%E9%80%A0%E8%B6%85%E7%BD%91%EF%BC%89"><span class="toc-number">3.3.2.</span> <span class="toc-text">路由聚合（构造超网）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4%E5%9C%B0%E5%9D%80%E7%9A%84%E5%BA%94%E7%94%A8%E8%A7%84%E5%88%92"><span class="toc-number">3.4.</span> <span class="toc-text">IPv4地址的应用规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E9%95%BF%E7%9A%84%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81FLSM%EF%BC%88Fixed-Length-Subnet-Mask%EF%BC%89"><span class="toc-number">3.4.1.</span> <span class="toc-text">定长的子网掩码FLSM（Fixed Length Subnet Mask）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%95%BF%E7%9A%84%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81VLSM%EF%BC%88Variable-Length-Subnet-Mask%EF%BC%89"><span class="toc-number">3.4.2.</span> <span class="toc-text">变长的子网掩码VLSM（Variable Length Subnet Mask）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">IP数据报的发送和转发过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E9%80%81IP%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.1.</span> <span class="toc-text">主机发送IP数据报</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%B8%BB%E6%9C%BA%E5%88%A4%E6%96%AD%E7%9B%AE%E7%9A%84%E4%B8%BB%E6%9C%BA%E6%98%AF%E5%90%A6%E4%B8%8E%E8%87%AA%E5%B7%B1%E5%9C%A8%E5%90%8C%E4%B8%80%E7%BD%91%E7%BB%9C"><span class="toc-number">4.1.1.</span> <span class="toc-text">源主机判断目的主机是否与自己在同一网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E4%B8%BB%E6%9C%BA%E5%88%A4%E6%96%AD%E9%97%B4%E6%8E%A5%E4%BA%A4%E4%BB%98%E6%89%80%E7%94%A8%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">源主机判断间接交付所用路由器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E8%BD%AC%E5%8F%91IP%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.2.</span> <span class="toc-text">路由器转发IP数据报</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">静态路由配置及其可能产生的路由环路问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.</span> <span class="toc-text">静态路由配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1"><span class="toc-number">5.2.</span> <span class="toc-text">默认路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E4%B8%BB%E6%9C%BA%E8%B7%AF%E7%94%B1"><span class="toc-number">5.3.</span> <span class="toc-text">特定主机路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF"><span class="toc-number">5.4.</span> <span class="toc-text">静态路由配置错误导致路由环路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%BD%91%E7%BB%9C%E8%80%8C%E5%AF%BC%E8%87%B4%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF"><span class="toc-number">5.5.</span> <span class="toc-text">聚合不存在网络而导致路由环路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%95%85%E9%9A%9C%E8%80%8C%E5%AF%BC%E8%87%B4%E8%B7%AF%E7%94%B1%E7%8E%AF%E8%B7%AF"><span class="toc-number">5.6.</span> <span class="toc-text">网络故障而导致路由环路</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">6.1.</span> <span class="toc-text">路由选择协议概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%EF%BC%9A"><span class="toc-number">6.1.1.</span> <span class="toc-text">静态路由选择：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%EF%BC%9A"><span class="toc-number">6.1.2.</span> <span class="toc-text">动态路由选择：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%A0%E7%89%B9%E7%BD%91%E6%89%80%E9%87%87%E7%94%A8%E7%9A%84%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="toc-number">6.1.3.</span> <span class="toc-text">因特网所采用的路由选择协议的主要特点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE%EF%BC%9A"><span class="toc-number">6.1.4.</span> <span class="toc-text">常见的路由选择协议：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.5.</span> <span class="toc-text">路由器的基本结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AERIP%EF%BC%88Routing-Information-Protocol%EF%BC%89"><span class="toc-number">6.2.</span> <span class="toc-text">路由信息协议RIP（Routing Information Protocol）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RIP%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">6.2.1.</span> <span class="toc-text">RIP的基本工作过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RIP%E7%9A%84%E8%B7%AF%E7%94%B1%E6%9D%A1%E7%9B%AE%E6%9B%B4%E6%96%B0%E8%A7%84%E5%88%99"><span class="toc-number">6.2.2.</span> <span class="toc-text">RIP的路由条目更新规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9C%E5%9D%8F%E6%B6%88%E6%81%AF%E4%BC%A0%E5%BE%97%E6%85%A2%E2%80%9D%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">6.2.3.</span> <span class="toc-text">“坏消息传得慢”的问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88OSFP%EF%BC%88Open-Shortest-Path-First%EF%BC%89%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">6.3.</span> <span class="toc-text">开放最短路径优先OSFP（Open Shortest Path First）的基本工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E4%B8%AD%E7%9A%84%E9%82%BB%E5%B1%85%E5%85%B3%E7%B3%BB"><span class="toc-number">6.3.1.</span> <span class="toc-text">OSPF中的邻居关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E7%9A%84LSA%E5%92%8CLSU"><span class="toc-number">6.3.2.</span> <span class="toc-text">OSPF的LSA和LSU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E7%9A%84LDB"><span class="toc-number">6.3.3.</span> <span class="toc-text">OSPF的LDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E4%B8%AD%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">6.3.4.</span> <span class="toc-text">OSPF中最短路径的获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E7%9A%84%E5%88%86%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.3.5.</span> <span class="toc-text">OSPF的分组类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">6.3.6.</span> <span class="toc-text">OSPF的基本工作过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E5%9C%A8%E5%A4%9A%E7%82%B9%E6%8E%A5%E5%85%A5%E7%BD%91%E7%BB%9C%E4%B8%AD%E8%B7%AF%E7%94%B1%E5%99%A8%E9%82%BB%E5%B1%85%E5%85%B3%E7%B3%BB%E7%9A%84%E5%BB%BA%E7%AB%8B"><span class="toc-number">6.3.7.</span> <span class="toc-text">OSPF在多点接入网络中路由器邻居关系的建立</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E5%88%86%E5%B1%82%E6%AC%A1%E5%88%92%E5%88%86%E5%8C%BA%E5%9F%9F"><span class="toc-number">6.3.8.</span> <span class="toc-text">OSPF分层次划分区域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEBGP%EF%BC%88Border-Gateway-Protocol%EF%BC%89"><span class="toc-number">6.4.</span> <span class="toc-text">边界网关协议BGP（Border Gateway Protocol）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BGP%E5%8F%91%E8%A8%80%E4%BA%BA"><span class="toc-number">6.4.1.</span> <span class="toc-text">BGP发言人</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BGP%E5%8F%91%E8%A8%80%E4%BA%BA%E4%BA%A4%E6%8D%A2%E8%B7%AF%E5%BE%84%E5%90%91%E9%87%8F"><span class="toc-number">6.4.2.</span> <span class="toc-text">BGP发言人交换路径向量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BGP-4%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%8A%A5%E6%96%87"><span class="toc-number">6.4.3.</span> <span class="toc-text">BGP-4的四种报文</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RIP%E3%80%81OSPF%E3%80%81BGP%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">6.5.</span> <span class="toc-text">RIP、OSPF、BGP的封装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">IPv4数据报的首部格式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E3%80%81%E9%A6%96%E9%83%A8%E9%95%BF%E5%BA%A6%E3%80%81%E5%8C%BA%E5%88%86%E6%9C%8D%E5%8A%A1%E3%80%81%E6%80%BB%E9%95%BF%E5%BA%A6%E5%AD%97%E6%AE%B5"><span class="toc-number">7.1.</span> <span class="toc-text">版本、首部长度、区分服务、总长度字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%87%E8%AF%86%E3%80%81%E6%A0%87%E5%BF%97%E3%80%81%E7%89%87%E5%81%8F%E7%A7%BB%E5%AD%97%E6%AE%B5"><span class="toc-number">7.2.</span> <span class="toc-text">标识、标志、片偏移字段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%89%87%E4%B8%BE%E4%BE%8B"><span class="toc-number">7.2.1.</span> <span class="toc-text">分片举例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%AD%98%E6%97%B6%E9%97%B4%E3%80%81%E5%8D%8F%E8%AE%AE%E3%80%81%E9%A6%96%E9%83%A8%E6%A3%80%E9%AA%8C%E5%92%8C%E5%AD%97%E6%AE%B5"><span class="toc-number">7.3.</span> <span class="toc-text">生存时间、协议、首部检验和字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90IP%E5%9C%B0%E5%9D%80%E3%80%81%E7%9B%AE%E7%9A%84IP%E5%9C%B0%E5%9D%80%E5%AD%97%E6%AE%B5"><span class="toc-number">7.4.</span> <span class="toc-text">源IP地址、目的IP地址字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E3%80%81%E5%A1%AB%E5%85%85%E5%AD%97%E6%AE%B5"><span class="toc-number">7.5.</span> <span class="toc-text">可选、填充字段</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">网际控制报文协议ICMP（Internet Control Message Protocol）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ICMP%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87"><span class="toc-number">8.1.</span> <span class="toc-text">ICMP差错报告报文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E7%82%B9%E4%B8%8D%E5%8F%AF%E8%BE%BE"><span class="toc-number">8.1.1.</span> <span class="toc-text">终点不可达</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%82%B9%E6%8A%91%E5%88%B6"><span class="toc-number">8.1.2.</span> <span class="toc-text">源点抑制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E8%B6%85%E8%BF%87"><span class="toc-number">8.1.3.</span> <span class="toc-text">时间超过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E9%97%AE%E9%A2%98"><span class="toc-number">8.1.4.</span> <span class="toc-text">参数问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E8%B7%AF%E7%94%B1%EF%BC%88%E9%87%8D%E5%AE%9A%E5%90%91%EF%BC%89"><span class="toc-number">8.1.5.</span> <span class="toc-text">改变路由（重定向）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8F%91%E9%80%81ICMP%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">8.1.6.</span> <span class="toc-text">不发送ICMP差错报告报文的情况</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ICMP%E8%AF%A2%E9%97%AE%E6%8A%A5%E6%96%87"><span class="toc-number">8.2.</span> <span class="toc-text">ICMP询问报文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E7%94%A8%E4%BA%8E%E5%88%86%E7%BB%84%E7%BD%91%E9%97%B4%E6%8E%A2%E6%B5%8BPING%EF%BC%88Packet-InterNet-Groper%EF%BC%89"><span class="toc-number">8.2.1.</span> <span class="toc-text">ICMP用于分组网间探测PING（Packet InterNet Groper）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E7%94%A8%E4%BA%8E%E8%B7%9F%E8%B8%AA%E8%B7%AF%E7%94%B1%EF%BC%88traceroute%EF%BC%89"><span class="toc-number">8.2.2.</span> <span class="toc-text">ICMP用于跟踪路由（traceroute）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">8.2.2.1.</span> <span class="toc-text">工作原理</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">9.</span> <span class="toc-text">虚拟专用网VPN与网络地址转换NAT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN%EF%BC%88Virtual-Private-Network%EF%BC%89"><span class="toc-number">9.1.</span> <span class="toc-text">虚拟专用网VPN（Virtual Private Network）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT%EF%BC%88Network-Address-Translation%EF%BC%89"><span class="toc-number">9.2.</span> <span class="toc-text">网络地址转换NAT（Network Address Translation）</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"计算机网络网课笔记-网络层　| 小黎的小窝　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2022/03/20/computerInternet-5/" title="Pre: 计算机网络网课笔记-运输层">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2022/03/10/serializeAndDeserializeBinaryTree/" title="Next: 二叉树的序列化与反序列化">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/03/22/computerInternet-6/">计算机网络网课笔记-应用层</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/20/computerInternet-5/">计算机网络网课笔记-运输层</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/18/computerInternet-4/">计算机网络网课笔记-网络层</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/serializeAndDeserializeBinaryTree/">二叉树的序列化与反序列化</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/swapNodesInPairs/">两两交换链表中的节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/decodeWays/">解码方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/searchA2DMatrixII/">搜索二维矩阵II</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/combinationSum/">组合总和</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/copyListWithRandomPointer/">复制带随机指针的链表</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/longestPalindromicSubstring/">最长回文子串</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/minimumPathSum/">最小路径和</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/longestValidParentheses/">最长有效括号</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/10/generateParentheses/">括号生成</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/linkedListCycleII/">环形链表</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/mergeIntervals/">合并区间</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/findButtomLeftTreeValue/">找树左下角的值</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/excelSheetColumnTitle/">Excel表列名称</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/LRUCache/">LRU缓存</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/binaryTreeZigzagLevelOrderTraversal/">二叉树的锯齿形层序遍历</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/diameterOfBinaryTree/">二叉树的直径</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/3Sum/">三数之和</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/PermutationsII/">全排列II</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/09/courseSchedule/">课程表</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/searchInRotatedSortedArray/">搜索旋转排序数组</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/subarraySumEqualsK/">和为k的子数组</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/reverseWordsInString/">翻转字符串里的单词</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/longestSubstringWithoutRepeatingCharacters/">无重复字符的最大子串</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/rotateImage/">旋转图像</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/deleteNodeInBST/">删除二叉搜索树中的节点</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/08/maximumSubarray/">最大子数组和</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/07/lowestCommonAncestorOfABinaryTree/">二叉树的最近公共祖先</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/07/binaryTreeMaximumPathSum/">二叉树最大路径和</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/07/reverseList/">反转链表</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/07/kthBiggest/">数组中的第k个最大元素</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/01/center-img/">个人博客图片居中大法</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/01/md-20220301/">关于MarkDown语法中加粗失效的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/computerInternet-3/">计算机网络网课笔记-数据链路层</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/27/computerInternet-2/">计算机网络网课笔记-物理层</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/26/computerInternet-1/">计算机网络网课笔记-概论</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/25/c++11/">C++11特性</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/25/x&(x-1)/">x&(x-1)的使用</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2022 AngieLee
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg.webp)";
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>